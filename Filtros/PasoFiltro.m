%% Procesamiento de audio wav para el filtro IIR
clc;
close all;
clear all;

%%
figure(1);
[x,Fs]=audioread('elpasofs16000Nb16_3.wav');
x=x';
n=0:1/Fs:length(x)/Fs-1/Fs;
subplot(2,1,1);
plot(n,x);
xlabel('$Segundos$','Interpreter','latex');
ylabel('$Amplitud$','Interpreter','latex');
title('Señal en el tiempo: el paso del gigante');
axis([0 205 -.6 .6]);
grid on;

X=fftshift(fft(x,length(x)));
F2=-Fs/2:Fs/length(X):Fs/2-Fs/length(X);
subplot(2,1,2)
plot(F2,abs(X));
xlabel('$Hz$','Interpreter','latex');
ylabel('$Magnitud$','Interpreter','latex');
title('Señal en frecuencia');
grid on;

% [X,W]=freqz(x,1,1024);
% subplot(2,1,2);
% plot(W*Fs/(2*pi),abs(X));
%% Aplicacion de filtro FIR
yfir=conv(X,h);
figure(2);
plot(yfir);


sound(yfir,Fs);

%%
csvwrite('firCoeficientes.txt',h);

%%
%Filtrado del Paso con filtro FIR
clear all;
close all;
clc;
 
[x,FS]=audioread('elpasofs16000Nb16_3.wav');
x=x';
n=0:1/FS:length(x)/FS-1/FS;
 
figure (1)
subplot(2,1,1);
plot(n,x);
ylabel('Amplitud');
xlabel('Segundos');
title('Señal en el tiempo: elpasofs16000Nb16_2.wav');
%%sound(x,FS);
 
 
X=fftshift(fft(x,length(x)));
F2=-FS/2:FS/length(X):FS/2-FS/length(X);
subplot(2,1,2)
plot(F2,abs(X));

h=[-0.0123674790462498,0.00982068263514926,0.00641010275650739,0.00401184856889805,0.00233839226744668,0.00118741269422702,0.000411963709851059,-9.10191383932500e-05,-0.000398405222390053,-0.000563465026204657,-0.000628082054891564,-0.000620600789400135,-0.000565137439639331,-0.000477374392016191,-0.000372103712578723,-0.000258118001437483,-0.000145012222221257,-3.74126512936063e-05,5.83008179178817e-05,0.000140373328198309,0.000204720292827517,0.000251791734134423,0.000279370005714272,0.000289710065586905,0.000281983107396209,0.000259948724116952,0.000223789007190083,0.000178245922167333,0.000124016782776178,6.64757592604609e-05,6.37735674314597e-06,-5.07919447310649e-05,-0.000104868350660897,-0.000150544215313402,-0.000188544918233872,-0.000214138393538915,-0.000229474037011173,-0.000230419202030301,-0.000220840601011703,-0.000197025320976933,-0.000164775171187921,-0.000120454283532410,-7.19598806833665e-05,-1.48814128291555e-05,4.00139776700238e-05,0.000100701562536696,0.000148988848825058,0.000206153741482159,0.000233901765494303,0.000276245478959268,0.000288550906660940,0.000287234753914377,0.000291507590658802,0.000262351030927588,0.000222481865276338,0.000179091283349870,0.000126944015562613,5.60429015898200e-05,-1.76369834404470e-05,-8.85324420427292e-05,-0.000155480232707927,-0.000224904128296637,-0.000289058070508159,-0.000341874262809406,-0.000376775347411037,-0.000397461469990640,-0.000404071655388703,-0.000397148913266276,-0.000371599816161188,-0.000327288982534009,-0.000264882543808355,-0.000190281777541058,-0.000106550057175795,-1.73449507830486e-05,7.67402697515414e-05,0.000172387963341522,0.000266335555375418,0.000352404250964057,0.000426046808984780,0.000482896147279437,0.000521392189439653,0.000540200014873762,0.000538941091529469,0.000516638892844760,0.000472793889364288,0.000407698574539825,0.000322654113642271,0.000221292036147361,0.000107417505770837,-1.31364816114714e-05,-0.000136474780500493,-0.000256418372703731,-0.000370677416083170,-0.000472015309111126,-0.000560473863158579,-0.000626656217860843,-0.000672635165478737,-0.000691208612028096,-0.000680539578384697,-0.000646803450208958,-0.000578695529733113,-0.000491965886691460,-0.000381850830610955,-0.000252887294931530,-0.000112421021818289,3.34072315074256e-05,0.000185272733792070,0.000332122239785962,0.000468581792993756,0.000589717938626494,0.000692924778356976,0.000768942699904969,0.000815175418291399,0.000829702834637104,0.000813452524228676,0.000763350284105708,0.000681652565739998,0.000571292168836065,0.000438596038611855,0.000286218326825573,0.000119754699517404,-5.54836637073512e-05,-0.000230522290096803,-0.000399335069413318,-0.000554931108804472,-0.000692711685917732,-0.000805450897234963,-0.000888206762740286,-0.000935942655273865,-0.000947728908384924,-0.000922429317228323,-0.000861385763437211,-0.000765259523322475,-0.000637787360760772,-0.000483347554370738,-0.000308922219814862,-0.000120984395239969,7.29691244852719e-05,0.000266411684259905,0.000451777418168232,0.000621586366528019,0.000768622372930003,0.000886614287531513,0.000970624612476846,0.00101854764446314,0.00102563141130471,0.000995819048615914,0.000923216748663011,0.000817045040939242,0.000675995591019386,0.000508096354709674,0.000320661359691338,0.000119970610605561,-8.69730150372088e-05,-0.000289191770114567,-0.000482277775248709,-0.000656937517743562,-0.000805816655626268,-0.000922588675778924,-0.00100480487253838,-0.00104709099458537,-0.00104877932516046,-0.00101004899901735,-0.000933472825349968,-0.000819794117773262,-0.000674609116658798,-0.000503511782647284,-0.000314211668613737,-0.000112473506503454,9.24014878646815e-05,0.000292545798872309,0.000479238362727752,0.000647065992701094,0.000788663498141937,0.000898976724501569,0.000972589682501304,0.00100817525352565,0.00100397191708826,0.000961203520599822,0.000880668156615556,0.000767162574498527,0.000625267558451341,0.000462031679532603,0.000282870117447810,9.56585494580069e-05,-9.29959550519403e-05,-0.000274198143949814,-0.000441807963772281,-0.000588642577414470,-0.000710534277165324,-0.000801550687159654,-0.000860386537534961,-0.000882789427846467,-0.000872280326708737,-0.000826575825917857,-0.000752121403705256,-0.000649463507729897,-0.000524574447819526,-0.000383155020544533,-0.000230725701921675,-7.43123553229986e-05,7.87953400906605e-05,0.000224729870482916,0.000355749714203746,0.000467833847862032,0.000557023611200491,0.000620528735875420,0.000656064856420154,0.000665100452442853,0.000647434485445556,0.000605099278965101,0.000540637758584769,0.000458878085491381,0.000362863527699932,0.000258505249603471,0.000150679365749297,4.50317230203779e-05,-5.52897004295714e-05,-0.000145108498109961,-0.000221445326802910,-0.000281060251855465,-0.000323634984358903,-0.000347490728055201,-0.000353724158011633,-0.000343158418445185,-0.000319096618514389,-0.000282985636565787,-0.000238566863058458,-0.000188589484787976,-0.000137986139870673,-8.93291777076904e-05,-4.65366353941860e-05,-1.11425421643573e-05,1.35336343130464e-05,2.74471701000886e-05,2.93853518687169e-05,2.12863944621760e-05,2.98218870148795e-06,-2.20213324635059e-05,-5.28730773051672e-05,-8.38587655488886e-05,-0.000113703457846962,-0.000137194194057801,-0.000152695216492730,-0.000156738873763914,-0.000146641435829910,-0.000121676169696103,-8.08348821020137e-05,-2.43407526950846e-05,4.53312756028989e-05,0.000127345057529910,0.000216965043405850,0.000310086697946586,0.000401792566810359,0.000486704951043179,0.000558966817061490,0.000614539179854483,0.000647544687867712,0.000654152526213936,0.000630995210924233,0.000577004059559800,0.000490773911394599,0.000374475912596471,0.000230200336300833,6.26123835555105e-05,-0.000123241242290991,-0.000319133164729499,-0.000517926442100086,-0.000710542553419573,-0.000888616557771721,-0.00104207703902763,-0.00116323360889707,-0.00124377044256336,-0.00127793367908074,-0.00126026648210637,-0.00118941768332863,-0.00106436339320002,-0.000887617871599141,-0.000662585104592530,-0.000397124876545953,-9.92654707853267e-05,0.000219399138408934,0.000547679388530063,0.000871199611991364,0.00117711089937970,0.00145072947361134,0.00168029722409315,0.00185250825036836,0.00195852353933117,0.00198991505804784,0.00194261938931460,0.00181491016552905,0.00160765153380586,0.00132615298955340,0.000978335493803733,0.000575602517726507,0.000132787586165426,-0.000334967687885214,-0.000808431723593071,-0.00126900418698525,-0.00169740943755075,-0.00207494906694188,-0.00238425422428170,-0.00261073332104977,-0.00274097446883467,-0.00276708499496891,-0.00268371469659004,-0.00249066979011340,-0.00219113785740561,-0.00179422562306803,-0.00131152380813648,-0.000760285600162942,-0.000160021491411888,0.000466226634430611,0.00109509757210951,0.00170062611488777,0.00225840609826859,0.00274407019307735,0.00313659543778833,0.00341666283208460,0.00357044909263224,0.00358737750515728,0.00346316641286016,0.00319783079476650,0.00279890088714434,0.00227798901199275,0.00165291471120899,0.000944824783598755,0.000180570739272972,-0.000611713660533974,-0.00140068899627661,-0.00215553030603116,-0.00284460428458815,-0.00343973281149535,-0.00391433360634480,-0.00424720236690283,-0.00442097308144936,-0.00442504777583525,-0.00425550030625563,-0.00391450949912682,-0.00341176764402170,-0.00276327444659530,-0.00199115345911898,-0.00112395444876706,-0.000192813879659555,0.000765943047762300,0.00171574084293739,0.00261862299831107,0.00343803639241267,0.00413991894564060,0.00469454175721669,0.00507584559607335,0.00526632969196849,0.00525396177412327,0.00503600585183698,0.00461646170940099,0.00400844719028421,0.00323154645534969,0.00231413799881593,0.00128909132656270,0.000195192421571645,-0.000926282856257536,-0.00203107356702609,-0.00307619725311129,-0.00401890992632216,-0.00482092526018288,-0.00544789890218235,-0.00587289663238753,-0.00607521419829004,-0.00604391780683092,-0.00577602391046302,-0.00527885188508622,-0.00456758259628913,-0.00366735211005387,-0.00261009351544043,-0.00143548997556198,-0.000187310427685392,0.00108588783599796,0.00233516464452929,0.00351103522959011,0.00456677659370410,0.00545871132996135,0.00615024835708027,0.00661143879459343,0.00682124655919511,0.00676811323541384,0.00645056659926631,0.00587784452304186,0.00506937070596062,0.00405330782380907,0.00286786762602868,0.00155636316206526,0.000169426557124874,-0.00124034584607203,-0.00261761360934942,-0.00390836568157358,-0.00506109772647025,-0.00602988891741087,-0.00677401471560242,-0.00726313064164438,-0.00747433844378907,-0.00739749972946970,-0.00703229182488091,-0.00639061846985597,-0.00549423405376257,-0.00437644832195635,-0.00307817529732404,-0.00164888738689116,-0.000142597180077193,0.00138216300901075,0.00286650186296086,0.00425161484825972,0.00548339308247478,0.00651209746239667,0.00729632015088272,0.00780306049741737,0.00801114518954940,0.00790979522891471,0.00750122705292175,0.00679860244501112,0.00582767453990819,0.00462392883009518,0.00323325507845223,0.00170817154445906,0.000107667048273951,-0.00150701094814979,-0.00307272138151948,-0.00452854564571125,-0.00581687225670403,-0.00688703654180258,-0.00769571606022263,-0.00821049560498574,-0.00840983613918332,-0.00828446874478425,-0.00783752493385550,-0.00708549248495277,-0.00605542677980162,-0.00478703965824060,-0.00332748653519389,-0.00173386222323073,-6.69775636856897e-05,0.00160834100387439,0.00322741594751694,0.00472668804292026,0.00604810760310329,0.00713891818676447,0.00795724045792903,0.00846940391714847,0.00865574625444677,0.00850765226198611,0.00803032479327141,0.00724116868123934,0.00617066986913756,0.00485935851872174,0.00335827788199892,0.00172493569102997,2.28391737113462e-05,-0.00168241322326915,-0.00332408505898521,-0.00483891829365879,-0.00616765426577914,-0.00725917942468836,-0.00807050647951968,-0.00857043101786785,0.991260939934550,-0.00857043101786785,-0.00807050647951968,-0.00725917942468836,-0.00616765426577914,-0.00483891829365879,-0.00332408505898521,-0.00168241322326915,2.28391737113462e-05,0.00172493569102997,0.00335827788199892,0.00485935851872174,0.00617066986913756,0.00724116868123934,0.00803032479327141,0.00850765226198611,0.00865574625444677,0.00846940391714847,0.00795724045792903,0.00713891818676447,0.00604810760310329,0.00472668804292026,0.00322741594751694,0.00160834100387439,-6.69775636856897e-05,-0.00173386222323073,-0.00332748653519389,-0.00478703965824060,-0.00605542677980162,-0.00708549248495277,-0.00783752493385550,-0.00828446874478425,-0.00840983613918332,-0.00821049560498574,-0.00769571606022263,-0.00688703654180258,-0.00581687225670403,-0.00452854564571125,-0.00307272138151948,-0.00150701094814979,0.000107667048273951,0.00170817154445906,0.00323325507845223,0.00462392883009518,0.00582767453990819,0.00679860244501112,0.00750122705292175,0.00790979522891471,0.00801114518954940,0.00780306049741737,0.00729632015088272,0.00651209746239667,0.00548339308247478,0.00425161484825972,0.00286650186296086,0.00138216300901075,-0.000142597180077193,-0.00164888738689116,-0.00307817529732404,-0.00437644832195635,-0.00549423405376257,-0.00639061846985597,-0.00703229182488091,-0.00739749972946970,-0.00747433844378907,-0.00726313064164438,-0.00677401471560242,-0.00602988891741087,-0.00506109772647025,-0.00390836568157358,-0.00261761360934942,-0.00124034584607203,0.000169426557124874,0.00155636316206526,0.00286786762602868,0.00405330782380907,0.00506937070596062,0.00587784452304186,0.00645056659926631,0.00676811323541384,0.00682124655919511,0.00661143879459343,0.00615024835708027,0.00545871132996135,0.00456677659370410,0.00351103522959011,0.00233516464452929,0.00108588783599796,-0.000187310427685392,-0.00143548997556198,-0.00261009351544043,-0.00366735211005387,-0.00456758259628913,-0.00527885188508622,-0.00577602391046302,-0.00604391780683092,-0.00607521419829004,-0.00587289663238753,-0.00544789890218235,-0.00482092526018288,-0.00401890992632216,-0.00307619725311129,-0.00203107356702609,-0.000926282856257536,0.000195192421571645,0.00128909132656270,0.00231413799881593,0.00323154645534969,0.00400844719028421,0.00461646170940099,0.00503600585183698,0.00525396177412327,0.00526632969196849,0.00507584559607335,0.00469454175721669,0.00413991894564060,0.00343803639241267,0.00261862299831107,0.00171574084293739,0.000765943047762300,-0.000192813879659555,-0.00112395444876706,-0.00199115345911898,-0.00276327444659530,-0.00341176764402170,-0.00391450949912682,-0.00425550030625563,-0.00442504777583525,-0.00442097308144936,-0.00424720236690283,-0.00391433360634480,-0.00343973281149535,-0.00284460428458815,-0.00215553030603116,-0.00140068899627661,-0.000611713660533974,0.000180570739272972,0.000944824783598755,0.00165291471120899,0.00227798901199275,0.00279890088714434,0.00319783079476650,0.00346316641286016,0.00358737750515728,0.00357044909263224,0.00341666283208460,0.00313659543778833,0.00274407019307735,0.00225840609826859,0.00170062611488777,0.00109509757210951,0.000466226634430611,-0.000160021491411888,-0.000760285600162942,-0.00131152380813648,-0.00179422562306803,-0.00219113785740561,-0.00249066979011340,-0.00268371469659004,-0.00276708499496891,-0.00274097446883467,-0.00261073332104977,-0.00238425422428170,-0.00207494906694188,-0.00169740943755075,-0.00126900418698525,-0.000808431723593071,-0.000334967687885214,0.000132787586165426,0.000575602517726507,0.000978335493803733,0.00132615298955340,0.00160765153380586,0.00181491016552905,0.00194261938931460,0.00198991505804784,0.00195852353933117,0.00185250825036836,0.00168029722409315,0.00145072947361134,0.00117711089937970,0.000871199611991364,0.000547679388530063,0.000219399138408934,-9.92654707853267e-05,-0.000397124876545953,-0.000662585104592530,-0.000887617871599141,-0.00106436339320002,-0.00118941768332863,-0.00126026648210637,-0.00127793367908074,-0.00124377044256336,-0.00116323360889707,-0.00104207703902763,-0.000888616557771721,-0.000710542553419573,-0.000517926442100086,-0.000319133164729499,-0.000123241242290991,6.26123835555105e-05,0.000230200336300833,0.000374475912596471,0.000490773911394599,0.000577004059559800,0.000630995210924233,0.000654152526213936,0.000647544687867712,0.000614539179854483,0.000558966817061490,0.000486704951043179,0.000401792566810359,0.000310086697946586,0.000216965043405850,0.000127345057529910,4.53312756028989e-05,-2.43407526950846e-05,-8.08348821020137e-05,-0.000121676169696103,-0.000146641435829910,-0.000156738873763914,-0.000152695216492730,-0.000137194194057801,-0.000113703457846962,-8.38587655488886e-05,-5.28730773051672e-05,-2.20213324635059e-05,2.98218870148795e-06,2.12863944621760e-05,2.93853518687169e-05,2.74471701000886e-05,1.35336343130464e-05,-1.11425421643573e-05,-4.65366353941860e-05,-8.93291777076904e-05,-0.000137986139870673,-0.000188589484787976,-0.000238566863058458,-0.000282985636565787,-0.000319096618514389,-0.000343158418445185,-0.000353724158011633,-0.000347490728055201,-0.000323634984358903,-0.000281060251855465,-0.000221445326802910,-0.000145108498109961,-5.52897004295714e-05,4.50317230203779e-05,0.000150679365749297,0.000258505249603471,0.000362863527699932,0.000458878085491381,0.000540637758584769,0.000605099278965101,0.000647434485445556,0.000665100452442853,0.000656064856420154,0.000620528735875420,0.000557023611200491,0.000467833847862032,0.000355749714203746,0.000224729870482916,7.87953400906605e-05,-7.43123553229986e-05,-0.000230725701921675,-0.000383155020544533,-0.000524574447819526,-0.000649463507729897,-0.000752121403705256,-0.000826575825917857,-0.000872280326708737,-0.000882789427846467,-0.000860386537534961,-0.000801550687159654,-0.000710534277165324,-0.000588642577414470,-0.000441807963772281,-0.000274198143949814,-9.29959550519403e-05,9.56585494580069e-05,0.000282870117447810,0.000462031679532603,0.000625267558451341,0.000767162574498527,0.000880668156615556,0.000961203520599822,0.00100397191708826,0.00100817525352565,0.000972589682501304,0.000898976724501569,0.000788663498141937,0.000647065992701094,0.000479238362727752,0.000292545798872309,9.24014878646815e-05,-0.000112473506503454,-0.000314211668613737,-0.000503511782647284,-0.000674609116658798,-0.000819794117773262,-0.000933472825349968,-0.00101004899901735,-0.00104877932516046,-0.00104709099458537,-0.00100480487253838,-0.000922588675778924,-0.000805816655626268,-0.000656937517743562,-0.000482277775248709,-0.000289191770114567,-8.69730150372088e-05,0.000119970610605561,0.000320661359691338,0.000508096354709674,0.000675995591019386,0.000817045040939242,0.000923216748663011,0.000995819048615914,0.00102563141130471,0.00101854764446314,0.000970624612476846,0.000886614287531513,0.000768622372930003,0.000621586366528019,0.000451777418168232,0.000266411684259905,7.29691244852719e-05,-0.000120984395239969,-0.000308922219814862,-0.000483347554370738,-0.000637787360760772,-0.000765259523322475,-0.000861385763437211,-0.000922429317228323,-0.000947728908384924,-0.000935942655273865,-0.000888206762740286,-0.000805450897234963,-0.000692711685917732,-0.000554931108804472,-0.000399335069413318,-0.000230522290096803,-5.54836637073512e-05,0.000119754699517404,0.000286218326825573,0.000438596038611855,0.000571292168836065,0.000681652565739998,0.000763350284105708,0.000813452524228676,0.000829702834637104,0.000815175418291399,0.000768942699904969,0.000692924778356976,0.000589717938626494,0.000468581792993756,0.000332122239785962,0.000185272733792070,3.34072315074256e-05,-0.000112421021818289,-0.000252887294931530,-0.000381850830610955,-0.000491965886691460,-0.000578695529733113,-0.000646803450208958,-0.000680539578384697,-0.000691208612028096,-0.000672635165478737,-0.000626656217860843,-0.000560473863158579,-0.000472015309111126,-0.000370677416083170,-0.000256418372703731,-0.000136474780500493,-1.31364816114714e-05,0.000107417505770837,0.000221292036147361,0.000322654113642271,0.000407698574539825,0.000472793889364288,0.000516638892844760,0.000538941091529469,0.000540200014873762,0.000521392189439653,0.000482896147279437,0.000426046808984780,0.000352404250964057,0.000266335555375418,0.000172387963341522,7.67402697515414e-05,-1.73449507830486e-05,-0.000106550057175795,-0.000190281777541058,-0.000264882543808355,-0.000327288982534009,-0.000371599816161188,-0.000397148913266276,-0.000404071655388703,-0.000397461469990640,-0.000376775347411037,-0.000341874262809406,-0.000289058070508159,-0.000224904128296637,-0.000155480232707927,-8.85324420427292e-05,-1.76369834404470e-05,5.60429015898200e-05,0.000126944015562613,0.000179091283349870,0.000222481865276338,0.000262351030927588,0.000291507590658802,0.000287234753914377,0.000288550906660940,0.000276245478959268,0.000233901765494303,0.000206153741482159,0.000148988848825058,0.000100701562536696,4.00139776700238e-05,-1.48814128291555e-05,-7.19598806833665e-05,-0.000120454283532410,-0.000164775171187921,-0.000197025320976933,-0.000220840601011703,-0.000230419202030301,-0.000229474037011173,-0.000214138393538915,-0.000188544918233872,-0.000150544215313402,-0.000104868350660897,-5.07919447310649e-05,6.37735674314597e-06,6.64757592604609e-05,0.000124016782776178,0.000178245922167333,0.000223789007190083,0.000259948724116952,0.000281983107396209,0.000289710065586905,0.000279370005714272,0.000251791734134423,0.000204720292827517,0.000140373328198309,5.83008179178817e-05,-3.74126512936063e-05,-0.000145012222221257,-0.000258118001437483,-0.000372103712578723,-0.000477374392016191,-0.000565137439639331,-0.000620600789400135,-0.000628082054891564,-0.000563465026204657,-0.000398405222390053,-9.10191383932500e-05,0.000411963709851059,0.00118741269422702,0.00233839226744668,0.00401184856889805,0.00641010275650739,0.00982068263514926,-0.0123674790462498];
n1=0:1/FS:0.01;
y1=conv(h,x);
h2=[0.00895141127574868,-0.0131347542753968,-0.00557553410503810,-0.00164112315457993,0.000254559990556604,0.00100353520343296,0.00111552442104017,0.000898196406772589,0.000538966895431591,0.000160364392881769,-0.000164951984187693,-0.000392703329072193,-0.000508656896408211,-0.000514301261582334,-0.000430755336276682,-0.000284645521796667,-0.000111582841397262,5.81479839186749e-05,0.000194599139303478,0.000281117762181988,0.000306628541346636,0.000275441988246294,0.000196159268340710,8.91490910492341e-05,-2.69084026123577e-05,-0.000128566334393801,-0.000201223127876550,-0.000231147199487810,-0.000217708494841104,-0.000162712438430476,-8.03004791852889e-05,1.64943946436712e-05,0.000107041752501865,0.000177955691250840,0.000213726907381650,0.000211145337904682,0.000167652923173061,9.41976465412703e-05,3.80159340237373e-07,-9.36888227651537e-05,-0.000174862272570879,-0.000224675044954763,-0.000237636758912306,-0.000206273100704921,-0.000139364206257574,-4.27894733704411e-05,6.24274978348805e-05,0.000164159690701549,0.000238227795761705,0.000278257846913802,0.000267644279749233,0.000216171188612403,0.000119910650065368,3.84541643007795e-06,-0.000118898853076259,-0.000234696758416283,-0.000297861686324696,-0.000341350492414887,-0.000305515999398820,-0.000227649777685647,-0.000115438428264677,3.03353051719736e-05,0.000179591528220080,0.000294259740925949,0.000371520441373438,0.000397549701184129,0.000356825503641547,0.000250397905109923,0.000104157072975480,-6.07568922692575e-05,-0.000224597571298450,-0.000364221975004101,-0.000449473750155473,-0.000462280345175229,-0.000400792495549131,-0.000276968552587306,-0.000106560913394635,8.85902313117262e-05,0.000280004015420974,0.000434216770596248,0.000522788648681365,0.000529700205580371,0.000453909328775534,0.000306418047178661,0.000106945129186172,-0.000116886309391767,-0.000331832513829191,-0.000502271789756211,-0.000598511736736992,-0.000601860274348816,-0.000510402512933767,-0.000336677062203200,-0.000106985874102497,0.000145696168907248,0.000382885731686027,0.000568866878195379,0.000671766561003785,0.000673306004225362,0.000568322551033408,0.000371690874386094,0.000110763791735104,-0.000172660233095864,-0.000436590089913629,-0.000637001365520365,-0.000745105801706228,-0.000738573335270148,-0.000620623284670364,-0.000401396638420896,-0.000117456751954417,0.000193266135905687,0.000481779856708660,0.000699162980401287,0.000817735980308454,0.000805794396640211,0.000672170385894821,0.000431101057474877,0.000116678989750723,-0.000219329362034146,-0.000526263689877262,-0.000760166742549366,-0.000878486489838264,-0.000862932128296504,-0.000716128261313488,-0.000456680895684618,-0.000120412505891684,0.000238531178429787,0.000565733121867560,0.000812194361928155,0.000938195610124799,0.000919803826848306,0.000759039983589314,0.000480176851750770,0.000124071507896543,-0.000256820107498148,-0.000602640159600345,-0.000858287683068506,-0.000984062315012493,-0.000960710894082149,-0.000789809285945007,-0.000495154139818199,-0.000121303099371108,0.000273745428617342,0.000629201548648141,0.000891282486379783,0.00101944397510834,0.000992520197403811,0.000812614948764575,0.000506826577125933,0.000121900046266721,-0.000283054640109446,-0.000647148941156712,-0.000914329749364653,-0.00104311368257744,-0.00101191910136797,-0.000825415492985408,-0.000511712811705875,-0.000119901759092975,0.000291303400367519,0.000658033399072267,0.000925792380527637,0.00105069537123111,0.00101598505407036,0.000823805909495907,0.000507807238179140,0.000113880064164973,-0.000295308029593001,-0.000657862057823432,-0.000920412655051694,-0.00103960055732335,-0.00100100202257418,-0.000809139069900078,-0.000494310695830065,-0.000107756220515328,0.000292488886866589,0.000645398737153060,0.000895974497996481,0.00100895161873153,0.000967891093715637,0.000778985272750966,0.000473753808919828,0.000100915147907779,-0.000283207788076995,-0.000618948648589975,-0.000854931805257337,-0.000957928177001859,-0.000914843067684776,-0.000733344698169678,-0.000443510504560465,-9.21892794338068e-05,0.000266383359225830,0.000577920559662386,0.000795040914377848,0.000886035351753219,0.000840704262457184,0.000669778030174880,0.000401923719760058,8.02092055740438e-05,-0.000244171685593152,-0.000521763237438949,-0.000712250437711788,-0.000789440748614490,-0.000744469074251730,-0.000588244168637726,-0.000349023339579481,-6.68976221042622e-05,0.000213876160013306,0.000450427591410119,0.000608439827622844,0.000667001331376251,0.000622351770547598,0.000486667795692076,0.000285584316323457,5.25436201226572e-05,-0.000174360879998939,-0.000361208443526043,-0.000480286522207482,-0.000519721742008740,-0.000477149864729095,-0.000367479403783790,-0.000210438411736176,-3.63875651472934e-05,0.000126641996349366,0.000253765673615516,0.000327918963461974,0.000344562734291415,0.000306809020550586,0.000227071498310321,0.000125181947326268,2.01429145980831e-05,-6.84975451831088e-05,-0.000127522117232205,-0.000152256646426020,-0.000144323266811681,-0.000111798394936994,-6.86634915092270e-05,-2.81355381437310e-05,-2.01838202710358e-06,2.02936608186154e-06,-1.56988175069089e-05,-4.76625662017453e-05,-8.31919340675166e-05,-0.000108233639790276,-0.000109505874883237,-7.89812379814417e-05,-1.56377508748798e-05,7.47490733913192e-05,0.000177444991430073,0.000271806599754645,0.000335976297176825,0.000351465218418797,0.000305666019307409,0.000196431429268250,3.38732440811300e-05,-0.000160228501170003,-0.000356121398471287,-0.000518894558915928,-0.000614988709096198,-0.000619302520198209,-0.000520859403164067,-0.000324668470316224,-5.32796560959878e-05,0.000255379570632361,0.000552839990846200,0.000788597531061233,0.000917913279229142,0.000909473060777723,0.000752526133302251,0.000460838598522122,7.13034131054173e-05,-0.000359800987331021,-0.000766514591443802,-0.00107996884578132,-0.00124399414780651,-0.00121985128379722,-0.00100045844717455,-0.000606388279739889,-9.05970285211912e-05,0.000472562884094530,0.000995528540171781,0.00139185589512252,0.00159123966730044,0.00155089730340850,0.00126260781459479,0.000759557396946695,0.000108636703926499,-0.000593949486627919,-0.00123929854788303,-0.00172253051990377,-0.00195933137008051,-0.00189904390915881,-0.00153771776756117,-0.000917646651169364,-0.000124827913629366,0.000723507004649677,0.00149629196045968,0.00206948968557866,0.00234323020285713,0.00226186574815643,0.00182332289526907,0.00108163553789595,0.000140451155335764,-0.000859792898159636,-0.00176528852921340,-0.00243055291166834,-0.00274202450862294,-0.00263718948656356,-0.00211769046104778,-0.00124927991013812,-0.000155035311372630,0.00100236376570028,0.00204395254547688,0.00280354193443117,0.00315286233457240,0.00302337621862601,0.00241915266169771,0.00141954841044646,0.000167339022743429,-0.00115062107587918,-0.00233115866165254,-0.00318598334453720,-0.00357209895647636,-0.00341562253705851,-0.00272456194298380,-0.00159058477579574,-0.000177576587800398,0.00130329473473611,0.00262355597137966,0.00357448259132414,0.00399685071778109,0.00381191610323954,0.00303118662928248,0.00176118884491026,0.000185496321079760,-0.00145916122738217,-0.00291966267944667,-0.00396495541890093,-0.00442310648882677,-0.00420804724841294,-0.00333777525208539,-0.00193021513565074,-0.000191687223538509,0.00161674647884386,0.00321680752735232,0.00435646136684820,0.00484831005873557,0.00460275321454280,0.00364068749224872,0.00209599976657517,0.000195125753303651,-0.00177544732815188,-0.00351322584462963,-0.00474400631519854,-0.00526812858550618,-0.00499018275334584,-0.00393739370746570,-0.00225692771030746,-0.000196551548991765,0.00193368727029697,0.00380540379682331,0.00512506262941501,0.00567907007816344,0.00536856680730636,0.00422526002829470,0.00241135056273309,0.000194619228517803,-0.00208980793017222,-0.00409116362008534,-0.00549572673970168,-0.00607756375365630,-0.00573353808268331,-0.00450196376615333,-0.00255798201897555,-0.000190538860432800,0.00224235914165035,0.00436735615284328,0.00585264201593485,0.00645991626439330,0.00608272928207724,0.00476507415649606,0.00269636050606263,0.000184099433240608,-0.00239058032649997,-0.00463281363827619,-0.00619284964696142,-0.00682258327170104,-0.00641201796788133,-0.00501157591649775,-0.00282371948213124,-0.000175238047836031,0.00253258499382580,0.00488400744518661,0.00651362315585859,0.00716208002955058,0.00671920949749381,0.00523963352518804,0.00293999836012029,0.000163952341806769,-0.00266689766133098,-0.00511871857096745,-0.00681067429292326,-0.00747587207658747,-0.00700066956923076,-0.00544739822493779,-0.00304366199656127,-0.000150485576620188,0.00279308854689567,0.00533506318309304,0.00708265223032456,0.00775992053022344,0.00725389140635497,0.00563184277284192,0.00313364184697040,0.000134535938005043,-0.00290872208708422,-0.00553048540586976,-0.00732530283657102,-0.00801196034184994,-0.00747646566236441,-0.00579259238046822,-0.00320944787601390,-0.000117359929564377,0.00301338905259017,0.00570316579332911,0.00753760040108923,0.00822962518264838,0.00766654685722180,0.00592676475767344,0.00327043173632895,9.85215179367724e-05,-0.00310583305290794,-0.00585191049488579,-0.00771694530898891,-0.00841100856550574,-0.00782195963122185,-0.00603407207831537,-0.00331538956743171,-7.80996604011356e-05,0.00318517456849901,0.00597446976335408,0.00786135848783025,0.00855347539841573,0.00794122122428314,0.00611313494999118,0.00334476664781281,5.66190336862860e-05,-0.00324997097129904,-0.00606969233206840,-0.00796948751793550,-0.00865689151756798,-0.00802326129371355,-0.00616325989630331,-0.00335782001723260,-3.43430773040380e-05,0.00330041194287276,0.00613649671443732,0.00804032987092886,0.00871887926829902,0.00806771601358023,0.00618417251460247,0.00335504578209135,1.15008253024047e-05,-0.00333547051222084,-0.00617537619098979,-0.00807339190515451,0.991259901260659,-0.00807339190515451,-0.00617537619098979,-0.00333547051222084,1.15008253024047e-05,0.00335504578209135,0.00618417251460247,0.00806771601358023,0.00871887926829902,0.00804032987092886,0.00613649671443732,0.00330041194287276,-3.43430773040380e-05,-0.00335782001723260,-0.00616325989630331,-0.00802326129371355,-0.00865689151756798,-0.00796948751793550,-0.00606969233206840,-0.00324997097129904,5.66190336862860e-05,0.00334476664781281,0.00611313494999118,0.00794122122428314,0.00855347539841573,0.00786135848783025,0.00597446976335408,0.00318517456849901,-7.80996604011356e-05,-0.00331538956743171,-0.00603407207831537,-0.00782195963122185,-0.00841100856550574,-0.00771694530898891,-0.00585191049488579,-0.00310583305290794,9.85215179367724e-05,0.00327043173632895,0.00592676475767344,0.00766654685722180,0.00822962518264838,0.00753760040108923,0.00570316579332911,0.00301338905259017,-0.000117359929564377,-0.00320944787601390,-0.00579259238046822,-0.00747646566236441,-0.00801196034184994,-0.00732530283657102,-0.00553048540586976,-0.00290872208708422,0.000134535938005043,0.00313364184697040,0.00563184277284192,0.00725389140635497,0.00775992053022344,0.00708265223032456,0.00533506318309304,0.00279308854689567,-0.000150485576620188,-0.00304366199656127,-0.00544739822493779,-0.00700066956923076,-0.00747587207658747,-0.00681067429292326,-0.00511871857096745,-0.00266689766133098,0.000163952341806769,0.00293999836012029,0.00523963352518804,0.00671920949749381,0.00716208002955058,0.00651362315585859,0.00488400744518661,0.00253258499382580,-0.000175238047836031,-0.00282371948213124,-0.00501157591649775,-0.00641201796788133,-0.00682258327170104,-0.00619284964696142,-0.00463281363827619,-0.00239058032649997,0.000184099433240608,0.00269636050606263,0.00476507415649606,0.00608272928207724,0.00645991626439330,0.00585264201593485,0.00436735615284328,0.00224235914165035,-0.000190538860432800,-0.00255798201897555,-0.00450196376615333,-0.00573353808268331,-0.00607756375365630,-0.00549572673970168,-0.00409116362008534,-0.00208980793017222,0.000194619228517803,0.00241135056273309,0.00422526002829470,0.00536856680730636,0.00567907007816344,0.00512506262941501,0.00380540379682331,0.00193368727029697,-0.000196551548991765,-0.00225692771030746,-0.00393739370746570,-0.00499018275334584,-0.00526812858550618,-0.00474400631519854,-0.00351322584462963,-0.00177544732815188,0.000195125753303651,0.00209599976657517,0.00364068749224872,0.00460275321454280,0.00484831005873557,0.00435646136684820,0.00321680752735232,0.00161674647884386,-0.000191687223538509,-0.00193021513565074,-0.00333777525208539,-0.00420804724841294,-0.00442310648882677,-0.00396495541890093,-0.00291966267944667,-0.00145916122738217,0.000185496321079760,0.00176118884491026,0.00303118662928248,0.00381191610323954,0.00399685071778109,0.00357448259132414,0.00262355597137966,0.00130329473473611,-0.000177576587800398,-0.00159058477579574,-0.00272456194298380,-0.00341562253705851,-0.00357209895647636,-0.00318598334453720,-0.00233115866165254,-0.00115062107587918,0.000167339022743429,0.00141954841044646,0.00241915266169771,0.00302337621862601,0.00315286233457240,0.00280354193443117,0.00204395254547688,0.00100236376570028,-0.000155035311372630,-0.00124927991013812,-0.00211769046104778,-0.00263718948656356,-0.00274202450862294,-0.00243055291166834,-0.00176528852921340,-0.000859792898159636,0.000140451155335764,0.00108163553789595,0.00182332289526907,0.00226186574815643,0.00234323020285713,0.00206948968557866,0.00149629196045968,0.000723507004649677,-0.000124827913629366,-0.000917646651169364,-0.00153771776756117,-0.00189904390915881,-0.00195933137008051,-0.00172253051990377,-0.00123929854788303,-0.000593949486627919,0.000108636703926499,0.000759557396946695,0.00126260781459479,0.00155089730340850,0.00159123966730044,0.00139185589512252,0.000995528540171781,0.000472562884094530,-9.05970285211912e-05,-0.000606388279739889,-0.00100045844717455,-0.00121985128379722,-0.00124399414780651,-0.00107996884578132,-0.000766514591443802,-0.000359800987331021,7.13034131054173e-05,0.000460838598522122,0.000752526133302251,0.000909473060777723,0.000917913279229142,0.000788597531061233,0.000552839990846200,0.000255379570632361,-5.32796560959878e-05,-0.000324668470316224,-0.000520859403164067,-0.000619302520198209,-0.000614988709096198,-0.000518894558915928,-0.000356121398471287,-0.000160228501170003,3.38732440811300e-05,0.000196431429268250,0.000305666019307409,0.000351465218418797,0.000335976297176825,0.000271806599754645,0.000177444991430073,7.47490733913192e-05,-1.56377508748798e-05,-7.89812379814417e-05,-0.000109505874883237,-0.000108233639790276,-8.31919340675166e-05,-4.76625662017453e-05,-1.56988175069089e-05,2.02936608186154e-06,-2.01838202710358e-06,-2.81355381437310e-05,-6.86634915092270e-05,-0.000111798394936994,-0.000144323266811681,-0.000152256646426020,-0.000127522117232205,-6.84975451831088e-05,2.01429145980831e-05,0.000125181947326268,0.000227071498310321,0.000306809020550586,0.000344562734291415,0.000327918963461974,0.000253765673615516,0.000126641996349366,-3.63875651472934e-05,-0.000210438411736176,-0.000367479403783790,-0.000477149864729095,-0.000519721742008740,-0.000480286522207482,-0.000361208443526043,-0.000174360879998939,5.25436201226572e-05,0.000285584316323457,0.000486667795692076,0.000622351770547598,0.000667001331376251,0.000608439827622844,0.000450427591410119,0.000213876160013306,-6.68976221042622e-05,-0.000349023339579481,-0.000588244168637726,-0.000744469074251730,-0.000789440748614490,-0.000712250437711788,-0.000521763237438949,-0.000244171685593152,8.02092055740438e-05,0.000401923719760058,0.000669778030174880,0.000840704262457184,0.000886035351753219,0.000795040914377848,0.000577920559662386,0.000266383359225830,-9.21892794338068e-05,-0.000443510504560465,-0.000733344698169678,-0.000914843067684776,-0.000957928177001859,-0.000854931805257337,-0.000618948648589975,-0.000283207788076995,0.000100915147907779,0.000473753808919828,0.000778985272750966,0.000967891093715637,0.00100895161873153,0.000895974497996481,0.000645398737153060,0.000292488886866589,-0.000107756220515328,-0.000494310695830065,-0.000809139069900078,-0.00100100202257418,-0.00103960055732335,-0.000920412655051694,-0.000657862057823432,-0.000295308029593001,0.000113880064164973,0.000507807238179140,0.000823805909495907,0.00101598505407036,0.00105069537123111,0.000925792380527637,0.000658033399072267,0.000291303400367519,-0.000119901759092975,-0.000511712811705875,-0.000825415492985408,-0.00101191910136797,-0.00104311368257744,-0.000914329749364653,-0.000647148941156712,-0.000283054640109446,0.000121900046266721,0.000506826577125933,0.000812614948764575,0.000992520197403811,0.00101944397510834,0.000891282486379783,0.000629201548648141,0.000273745428617342,-0.000121303099371108,-0.000495154139818199,-0.000789809285945007,-0.000960710894082149,-0.000984062315012493,-0.000858287683068506,-0.000602640159600345,-0.000256820107498148,0.000124071507896543,0.000480176851750770,0.000759039983589314,0.000919803826848306,0.000938195610124799,0.000812194361928155,0.000565733121867560,0.000238531178429787,-0.000120412505891684,-0.000456680895684618,-0.000716128261313488,-0.000862932128296504,-0.000878486489838264,-0.000760166742549366,-0.000526263689877262,-0.000219329362034146,0.000116678989750723,0.000431101057474877,0.000672170385894821,0.000805794396640211,0.000817735980308454,0.000699162980401287,0.000481779856708660,0.000193266135905687,-0.000117456751954417,-0.000401396638420896,-0.000620623284670364,-0.000738573335270148,-0.000745105801706228,-0.000637001365520365,-0.000436590089913629,-0.000172660233095864,0.000110763791735104,0.000371690874386094,0.000568322551033408,0.000673306004225362,0.000671766561003785,0.000568866878195379,0.000382885731686027,0.000145696168907248,-0.000106985874102497,-0.000336677062203200,-0.000510402512933767,-0.000601860274348816,-0.000598511736736992,-0.000502271789756211,-0.000331832513829191,-0.000116886309391767,0.000106945129186172,0.000306418047178661,0.000453909328775534,0.000529700205580371,0.000522788648681365,0.000434216770596248,0.000280004015420974,8.85902313117262e-05,-0.000106560913394635,-0.000276968552587306,-0.000400792495549131,-0.000462280345175229,-0.000449473750155473,-0.000364221975004101,-0.000224597571298450,-6.07568922692575e-05,0.000104157072975480,0.000250397905109923,0.000356825503641547,0.000397549701184129,0.000371520441373438,0.000294259740925949,0.000179591528220080,3.03353051719736e-05,-0.000115438428264677,-0.000227649777685647,-0.000305515999398820,-0.000341350492414887,-0.000297861686324696,-0.000234696758416283,-0.000118898853076259,3.84541643007795e-06,0.000119910650065368,0.000216171188612403,0.000267644279749233,0.000278257846913802,0.000238227795761705,0.000164159690701549,6.24274978348805e-05,-4.27894733704411e-05,-0.000139364206257574,-0.000206273100704921,-0.000237636758912306,-0.000224675044954763,-0.000174862272570879,-9.36888227651537e-05,3.80159340237373e-07,9.41976465412703e-05,0.000167652923173061,0.000211145337904682,0.000213726907381650,0.000177955691250840,0.000107041752501865,1.64943946436712e-05,-8.03004791852889e-05,-0.000162712438430476,-0.000217708494841104,-0.000231147199487810,-0.000201223127876550,-0.000128566334393801,-2.69084026123577e-05,8.91490910492341e-05,0.000196159268340710,0.000275441988246294,0.000306628541346636,0.000281117762181988,0.000194599139303478,5.81479839186749e-05,-0.000111582841397262,-0.000284645521796667,-0.000430755336276682,-0.000514301261582334,-0.000508656896408211,-0.000392703329072193,-0.000164951984187693,0.000160364392881769,0.000538966895431591,0.000898196406772589,0.00111552442104017,0.00100353520343296,0.000254559990556604,-0.00164112315457993,-0.00557553410503810,-0.0131347542753968,0.00895141127574868];
y=conv(h2,y1);
%sound(y,FS);

figure(2)
subplot(2,1,1);
plot(y);
title('Señal filtrada en el dominio del tiempo')
xlabel('Tiempo (t)')
ylabel('Amplitud')
grid on
 
Y=fftshift(fft(y,length(y)));
F3=-FS/2:FS/length(Y):FS/2-FS/length(Y);
subplot(2,1,2)
plot(F3,abs(Y));

%%

%Filtrado del Paso con filtro IIR
clear all;
close all;
clc;

[x,FS]=audioread('elpasofs16000Nb16_2.wav');
x=x';
n=0:1/FS:length(x)/FS-1/FS;

figure (1)
subplot(2,1,1);
plot(n,x);
ylabel('Amplitud');
xlabel('Segundos');
title('Señal en el tiempo: elpasofs16000Nb16_2.wav');



X=fftshift(fft(x,length(x)));
F2=-FS/2:FS/length(X):FS/2-FS/length(X);
subplot(2,1,2)
plot(F2,abs(X));


b=[0.963363103566345,-7.12155640221101,23.5954392806195,-45.6880559091043,56.5021325240758,-45.6880559091043,23.5954392806195,-7.12155640221101,0.963363103566345];
a=[1,-7.32341478101753,24.0380783799175,-46.1118731420859,56.4962063753556,-45.2592776897768,23.1573840678614,-6.92465900975054,0.928068469312983];
b1=[0.852664231745608,-8.36681921153251,37.1031962702903,-97.9155660855280,170.286007537371,-203.918965426277,170.286007537371,-97.9155660855280,37.1031962702903,-8.36681921153251,0.852664231745608];
a1=[1,-9.50597786286518,40.8314896450545,-104.354022936290,175.722644142420,-203.706925366963,164.635557023669,-91.5962288847143,33.5729232383103,-7.32058096956620,0.721122029361413];

y=filter(b,a,x);
y1=filter(b1,a1,y);
sound(y1,FS);


figure(2)
subplot(2,1,1);
plot(y1);
title('Señal filtrada en el dominio del tiempo')
xlabel('Tiempo (t)')
ylabel('Amplitud')
grid on

Y=fftshift(fft(y1,length(y1)));
F3=-FS/2:FS/length(Y):FS/2-FS/length(Y);
subplot(2,1,2)
plot(F3,abs(Y));




